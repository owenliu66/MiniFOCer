#include "FastMath.h"

// Fast math tables
float math_LookupX[] = {
  0.  , 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1 ,
  0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2 , 0.21,
  0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3 , 0.31, 0.32,
  0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4 , 0.41, 0.42, 0.43,
  0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5 , 0.51, 0.52, 0.53, 0.54,
  0.55, 0.56, 0.57, 0.58, 0.59, 0.6 , 0.61, 0.62, 0.63, 0.64, 0.65,
  0.66, 0.67, 0.68, 0.69, 0.7 , 0.71, 0.72, 0.73, 0.74, 0.75, 0.76,
  0.77, 0.78, 0.79, 0.8 , 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87,
  0.88, 0.89, 0.9 , 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98,
  0.99};
int32_t sin_LookupXl[] = {
      0,   661,  1323,  1985,  2647,  3309,  3971,  4633,  5295,
   5957,  6619,  7281,  7943,  8605,  9267,  9929, 10591, 11253,
  11915, 12577, 13239, 13901, 14563, 15225, 15887, 16549, 17211,
  17873, 18535, 19197, 19859, 20521, 21183, 21845, 22506, 23168,
  23830, 24492, 25154, 25816, 26478, 27140, 27802, 28464, 29126,
  29788, 30450, 31112, 31774, 32436, 33098, 33760, 34422, 35084,
  35746, 36408, 37070, 37732, 38394, 39056, 39718, 40380, 41042,
  41704, 42366, 43028, 43690, 44351, 45013, 45675, 46337, 46999,
  47661, 48323, 48985, 49647, 50309, 50971, 51633, 52295, 52957,
  53619, 54281, 54943, 55605, 56267, 56929, 57591, 58253, 58915,
  59577, 60239, 60901, 61563, 62225, 62887, 63549, 64211, 64873,
  65535
};
float sin_LookupY[] = {
  0.00000000e+00,  6.27905195e-02,  1.25333234e-01,  1.87381315e-01,
  2.48689887e-01,  3.09016994e-01,  3.68124553e-01,  4.25779292e-01,
  4.81753674e-01,  5.35826795e-01,  5.87785252e-01,  6.37423990e-01,
  6.84547106e-01,  7.28968627e-01,  7.70513243e-01,  8.09016994e-01,
  8.44327926e-01,  8.76306680e-01,  9.04827052e-01,  9.29776486e-01,
  9.51056516e-01,  9.68583161e-01,  9.82287251e-01,  9.92114701e-01,
  9.98026728e-01,  1.00000000e+00,  9.98026728e-01,  9.92114701e-01,
  9.82287251e-01,  9.68583161e-01,  9.51056516e-01,  9.29776486e-01,
  9.04827052e-01,  8.76306680e-01,  8.44327926e-01,  8.09016994e-01,
  7.70513243e-01,  7.28968627e-01,  6.84547106e-01,  6.37423990e-01,
  5.87785252e-01,  5.35826795e-01,  4.81753674e-01,  4.25779292e-01,
  3.68124553e-01,  3.09016994e-01,  2.48689887e-01,  1.87381315e-01,
  1.25333234e-01,  6.27905195e-02,  1.22464680e-16, -6.27905195e-02,
  -1.25333234e-01, -1.87381315e-01, -2.48689887e-01, -3.09016994e-01,
  -3.68124553e-01, -4.25779292e-01, -4.81753674e-01, -5.35826795e-01,
  -5.87785252e-01, -6.37423990e-01, -6.84547106e-01, -7.28968627e-01,
  -7.70513243e-01, -8.09016994e-01, -8.44327926e-01, -8.76306680e-01,
  -9.04827052e-01, -9.29776486e-01, -9.51056516e-01, -9.68583161e-01,
  -9.82287251e-01, -9.92114701e-01, -9.98026728e-01, -1.00000000e+00,
  -9.98026728e-01, -9.92114701e-01, -9.82287251e-01, -9.68583161e-01,
  -9.51056516e-01, -9.29776486e-01, -9.04827052e-01, -8.76306680e-01,
  -8.44327926e-01, -8.09016994e-01, -7.70513243e-01, -7.28968627e-01,
  -6.84547106e-01, -6.37423990e-01, -5.87785252e-01, -5.35826795e-01,
  -4.81753674e-01, -4.25779292e-01, -3.68124553e-01, -3.09016994e-01,
  -2.48689887e-01, -1.87381315e-01, -1.25333234e-01, -6.27905195e-02
};
float cos_LookupY[] = {
  1.00000000e+00,  9.98026728e-01,  9.92114701e-01,  9.82287251e-01,
  9.68583161e-01,  9.51056516e-01,  9.29776486e-01,  9.04827052e-01,
  8.76306680e-01,  8.44327926e-01,  8.09016994e-01,  7.70513243e-01,
  7.28968627e-01,  6.84547106e-01,  6.37423990e-01,  5.87785252e-01,
  5.35826795e-01,  4.81753674e-01,  4.25779292e-01,  3.68124553e-01,
  3.09016994e-01,  2.48689887e-01,  1.87381315e-01,  1.25333234e-01,
  6.27905195e-02,  6.12323400e-17, -6.27905195e-02, -1.25333234e-01,
  -1.87381315e-01, -2.48689887e-01, -3.09016994e-01, -3.68124553e-01,
  -4.25779292e-01, -4.81753674e-01, -5.35826795e-01, -5.87785252e-01,
  -6.37423990e-01, -6.84547106e-01, -7.28968627e-01, -7.70513243e-01,
  -8.09016994e-01, -8.44327926e-01, -8.76306680e-01, -9.04827052e-01,
  -9.29776486e-01, -9.51056516e-01, -9.68583161e-01, -9.82287251e-01,
  -9.92114701e-01, -9.98026728e-01, -1.00000000e+00, -9.98026728e-01,
  -9.92114701e-01, -9.82287251e-01, -9.68583161e-01, -9.51056516e-01,
  -9.29776486e-01, -9.04827052e-01, -8.76306680e-01, -8.44327926e-01,
  -8.09016994e-01, -7.70513243e-01, -7.28968627e-01, -6.84547106e-01,
  -6.37423990e-01, -5.87785252e-01, -5.35826795e-01, -4.81753674e-01,
  -4.25779292e-01, -3.68124553e-01, -3.09016994e-01, -2.48689887e-01,
  -1.87381315e-01, -1.25333234e-01, -6.27905195e-02, -1.83697020e-16,
  6.27905195e-02,  1.25333234e-01,  1.87381315e-01,  2.48689887e-01,
  3.09016994e-01,  3.68124553e-01,  4.25779292e-01,  4.81753674e-01,
  5.35826795e-01,  5.87785252e-01,  6.37423990e-01,  6.84547106e-01,
  7.28968627e-01,  7.70513243e-01,  8.09016994e-01,  8.44327926e-01,
  8.76306680e-01,  9.04827052e-01,  9.29776486e-01,  9.51056516e-01,
  9.68583161e-01,  9.82287251e-01,  9.92114701e-01,  9.98026728e-01
};
uint16_t math_LookupSize = 100;


int32_t lookupTbl(const int32_t* source, const int32_t* target, const uint32_t size, const int32_t value) {
  uint32_t left = 0;
  uint32_t right = size - 1;
  uint32_t middle = (left + right) >> 1;
  while (right - left > 1) {
    if (source[middle] < value) {
      left = middle;
    }
    else if (source[middle] > value){
      right = middle;
    }
    else {
      return target[middle];
    }
    middle = (left + right) >> 1;
  }
  return (value - source[left]) * (target[right] - target[left]) / (source[right] - source[left]) + target[left];
}

float lookupTblf(const float* source, const float* target, const uint32_t size, const float value){
  uint32_t left = 0;
  uint32_t right = size - 1;
  uint32_t middle = (left + right) >> 1;
  while (right - left > 1) {
    if (source[middle] < value) {
      left = middle;
    }
    else if (source[middle] > value){
      right = middle;
    }
    else {
      return target[middle];
    }
    middle = (left + right) >> 1;
  }
  return (value - source[left]) * (target[right] - target[left]) / (source[right] - source[left]) + target[left];
}

float flookupTbll(const int32_t* source, const float* target, const uint32_t size, const int32_t value){
  uint32_t left = 0;
  uint32_t right = size - 1;
  uint32_t middle = (left + right) >> 1;
  while (right - left > 1) {
    if (source[middle] < value) {
      left = middle;
    }
    else if (source[middle] > value){
      right = middle;
    }
    else {
      return target[middle];
    }
    middle = (left + right) >> 1;
  }
  return (value - source[left]) * (target[right] - target[left]) / (source[right] - source[left]) + target[left];
}